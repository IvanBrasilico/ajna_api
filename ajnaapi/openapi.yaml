openapi: 3.0.1
info:
  title: API-AJNA
  description: API para acesso de outras aplicações a dados do AJNA
  version: "1.0b"
  termsOfService: "https://ajna.labin08.rf08.srf/"
  contact:
    url: "https://ajna.labin08.rf08.srf/"
    name: "Receita Federal"
    email: "ivan.brasilico@rfb.gov.br"
  license:
    name: Receita Federal C-level site
    url: "https://ajna.labin08.rf08.srf/site"
externalDocs:
  description: Documentação do Sistema
  url: "https://ajna.labin08.rf08.srf/ajna_docs"

servers:
  - url: /ajnaapi/api
tags:
  - name: autenticação
    description: Funções de autenticação de usuário
  - name: virasana
    description: Módulo de controle das imagens de inspeção não invasiva. Contém dados das imagens e da DUE. Integra dados API Recintos e Mercante.
    externalDocs:
      description: Site do módulo virasana
      url: https://ajna.labin08.rf08.srf/site2
  - name: bhadrasana
    description: Módulo de controle de risco e controle de carga, com registro das verificações físicas. Integra dados API Recintos, Laudos e Mercante.
    externalDocs:
      description: Site do módulo bhadrasana
      url: https://ajna.labin08.rf08.srf/ficha_site
  - name: mercante
    description: Dados importados dos arquivos XML do Mercante
  - name: API Recintos
    description: Dados importados da API Recintos

paths:
  /login:
    post:
      summary: retorna token JWT
      tags:
        - autenticação
      operationId: authentication.generate_token
      requestBody:
        description: Usuario e Senha
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthenticationJson'
      responses:
        '200':
          description: JWT token
          content:
            'text/plain':
              schema:
                type: string
  /login_certificado:
    post:
      summary: retorna token JWT
      tags:
        - autenticação
      operationId: authentication.generate_token
      requestBody:
        description: Certificado digital PKCS11
      responses:
        '200':
          description: JWT token
          content:
            'text/plain':
              schema:
                type: string
  /grid_data:
    post:
      summary: Consulta GridFS do MongoDB das imagens de escaneamento
      tags:
        - virasana
      requestBody:
        description: Campos do filtro a aplicar - padrão MongoDB
        content:
          application/json:
            schema:
              type: object
              properties:
                query:
                  type: object
                  properties:
                    campo:
                      type: string
                projection:
                  type: object
                  properties:
                    campo:
                      type: integer
              required:
                - query
      responses:
        200:
          description: JSON contendo os campos solicitados em projection
          content:
            application/json: {}
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /image/{id}:
    get:
      summary: "Retorna conteúdo da imagem de escaneamento - banco MongoDB principal"
      tags:
        - virasana
      parameters:
        - name: id
          in: path
          description: id da imagem do escaneamento no banco de dados AJNA
          required: true
          schema:
            type: string
      responses:
        200:
          description: Conteúdo em base64
          content:
            image/jpeg:
              schema:
                type: string
                format: binary
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /summary_aniita/{ce_mercante}:
    get:
      summary: Retorna um pequeno sumário dos dados do CE para visualização
      tags:
        - virasana
      parameters:
        - name: ce_mercante
          in: path
          description: número do conhecimento de transporte NIC CE Mercante
          required: true
          schema:
            type: string
      responses:
        200:
          description: Lista de contêineres do CE, algumas informações do sistema Mercante, id das imagens do CE
          content:
            application/json: {}
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /image_risco/{id}:
    get:
      summary: "Retorna fotos de verificação física e documentos PDF - Banco risco do MongoDB"
      tags:
        - bhadrasana
      parameters:
        - name: id
          in: path
          description: id da imagem do escaneamento no banco de dados AJNA
          required: true
          schema:
            type: string
      responses:
        200:
          description: Conteúdo em base64
          content:
            image/jpeg:
              schema:
                type: string
                format: binary
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /ficha/{id}:
    get:
      summary: Retorna conteúdo da Ficha de Controle de Carga
      tags:
        - bhadrasana
      parameters:
        - name: id
          in: path
          description: id da Ficha
          required: true
          schema:
            type: string
      responses:
        200:
          description: OVR
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OVR'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /fichas:
    post:
      summary: Retorna lista de Fichas de Controle de Carga
      tags:
        - bhadrasana
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OVRFiltro'
      responses:
        200:
          description: OVR
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  $ref: '#/components/schemas/OVR'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /rvf/{id}:
    get:
      summary: Retorna conteúdo da Verificação Física
      tags:
        - bhadrasana
      parameters:
        - name: id
          in: path
          description: id da Ficha
          required: true
          schema:
            type: string
      responses:
        200:
          description: RVF
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RVF'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /rvfs/{ovr_id}:
    get:
      summary: Retorna conteúdos da Verificações Físicas da OVR
      tags:
        - bhadrasana
      parameters:
        - name: ovr_id
          in: path
          description: id da Ficha
          required: true
          schema:
            type: string
      responses:
        200:
          description: RVF
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  $ref: '#/components/schemas/RVF'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /rvfs:
    post:
      summary: Retorna lista de Fichas de Controle de Carga
      tags:
        - bhadrasana
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RVFFiltro'
      responses:
        200:
          description: RVF
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  $ref: '#/components/schemas/RVF'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /imagens_rvf/{rvf_id}:
    get:
      summary: Retorna lista de imagens da RVF
      tags:
        - bhadrasana
      parameters:
        - name: rvf_id
          in: path
          description: id da RVF
          required: true
          schema:
            type: string
      responses:
        200:
          description: ImagemRVF
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  $ref: '#/components/schemas/ImagemRVF'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /tg/{id}:
    get:
      summary: Retorna conteúdo do TG
      tags:
        - bhadrasana
      parameters:
        - name: id
          in: path
          description: id do TG
          required: true
          schema:
            type: string
      responses:
        200:
          description: TGOVR
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TGOVR'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /tgs/{ovr_id}:
    get:
      summary: Retorna lista de TGs do OVR
      tags:
        - bhadrasana
      parameters:
        - name: ovr_id
          in: path
          description: id da Ficha
          required: true
          schema:
            type: string
      responses:
        200:
          description: TGOVR
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  $ref: '#/components/schemas/TGOVR'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /tgs:
    post:
      summary: Retorna lista de TGs conforme o Filtro
      tags:
        - bhadrasana
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TGFiltro'
      responses:
        200:
          description: TGOVR
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  $ref: '#/components/schemas/TGOVR'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /itemtg/{id}:
    get:
      summary: Retorna conteúdo do item do TG
      tags:
        - bhadrasana
      parameters:
        - name: id
          in: path
          description: id do itemtg
          required: true
          schema:
            type: string
      responses:
        200:
          description: ItemTG
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ItemTG'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /itenstg/{tg_id}:
    get:
      summary: Retorna lista itens do TG
      tags:
        - bhadrasana
      parameters:
        - name: tg_id
          in: path
          description: id do tg
          required: true
          schema:
            type: string
      responses:
        200:
          description: ItemTG
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  $ref: '#/components/schemas/ItemTG'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /minhas_fichas/{cpf}:
    get:
      summary: "Retorna lista de fichas atribuídas ao CPF para visualização"
      tags:
        - bhadrasana
      parameters:
        - name: cpf
          in: path
          description: CPF a consultar
          required: true
          schema:
            type: string
      responses:
        200:
          description: "Lista de dicionários contendo campos selecionados da OVR"
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  additionalProperties:
                    type: string
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /get_cpf_telegram/{telegram_user}:
    get:
      summary: "Retorna cpf do usuario se username telegram estiver cadastrado"
      tags:
        - bhadrasana
      parameters:
        - name: telegram_user
          in: path
          description: Username telegram
          required: true
          schema:
            type: string
      responses:
        200:
          description: CPF correspondente ao telegram
          content:
            application/json:
              schema:
                type: object
                properties:
                  cpf:
                    type: string
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /consulta_conteiner:
    post:
      summary: "Retorna resumo de informações para o conteiner {numero}: OVRs, RVFs, CEs, DUEs, Eventos"
      tags:
        - bhadrasana
      requestBody:
        description: Numero do container, data inicio e datafim
        content:
          application/json:
            schema:
              type: object
              properties:
                numerolote:
                  type: string
                datainicio:
                  type: string
                datafim:
                  type: string
      responses:
        200:
          description: "Lista de dicionários contendo campos selecionados dos sistemas"
          content:
            application/json:
              schema:
                type: object
                properties:
                  rvfs:
                    type: object
                    properties:
                      campo:
                        type: string
                  ovrs:
                    type: object
                    properties:
                      campo:
                        type: string
                  infoces:
                    type: object
                    properties:
                      campo:
                        type: string
                  dues:
                    type: object
                    properties:
                      campo:
                        type: string
                  eventos:
                    type: object
                    properties:
                      campo:
                        type: string
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /consulta_empresa:
    post:
      summary: "Retorna resumo de informações para a empresa {cnpj}: OVRs, CEs, DUEs, SAT/LABs"
      tags:
        - bhadrasana
      requestBody:
        description: CNPJ da Empresa, data inicio e data fim
        content:
          application/json:
            schema:
              type: object
              properties:
                cnpj:
                  type: string
                datainicio:
                  type: string
                datafim:
                  type: string
      responses:
        200:
          description: "Lista de dicionários contendo campos selecionados dos sistemas"
          content:
            application/json:
              schema:
                type: object
                properties:
                  ovrs:
                    type: object
                    properties:
                      campo:
                        type: string
                  infoces:
                    type: object
                    properties:
                      campo:
                        type: string
                  dues:
                    type: object
                    properties:
                      campo:
                        type: string
                  sats:
                    type: object
                    properties:
                      campo:
                        type: string
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /conhecimentos/{numeroCEmercante}:
    get:
      summary: Retorna objeto
      tags:
        - mercante
      parameters:
        - name: numeroCEmercante
          in: path
          description: Numero do CE Mercante no sistema original
          required: true
          schema:
            type: string
      responses:
        200:
          description: Conhecimento
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/conhecimentos'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /conhecimentos/new/{datamodificacao}:
    get:
      summary: Retorna lista de objetos com data de modificacao maior que a data passada
      tags:
        - mercante
      parameters:
        - name: datamodificacao
          in: path
          description: Data inicial de pesquisa
          required: true
          schema:
            type: string
      responses:
        200:
          description: Conhecimento
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/conhecimentos'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /conhecimentos:
    get:
      summary: Retorna lista de objetos correspondente ao filtro
      tags:
        - mercante
      responses:
        200:
          description: Conhecimento
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/conhecimentos'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /escalas/{numeroDaEscala}:
    get:
      summary: Retorna objeto
      tags:
        - mercante
      parameters:
        - name: numeroDaEscala
          in: path
          description: Numero da Escala no sistema original
          required: true
          schema:
            type: string
      responses:
        200:
          description: Escala
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Escala'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /escalas/new/{datamodificacao}:
    get:
      summary: Retorna lista de objetos com data de modificacao maior que a data passada
      tags:
        - mercante
      parameters:
        - name: datamodificacao
          in: path
          description: Data inicial de pesquisa
          required: true
          schema:
            type: string
      responses:
        200:
          description: Escala
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Escala'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /escalas:
    get:
      summary: Retorna lista de objetos correspondente ao filtro
      tags:
        - mercante
      responses:
        200:
          description: Escala
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Escala'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /manifestos/{numero}:
    get:
      summary: Retorna objeto
      tags:
        - mercante
      parameters:
        - name: numero
          in: path
          description: Numero do Manifesto no sistema original
          required: true
          schema:
            type: string
      responses:
        200:
          description: Conhecimento
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/manifestos'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /manifestos/new/{datamodificacao}:
    get:
      summary: Retorna lista de objetos com data de modificacao maior que a data passada
      tags:
        - mercante
      parameters:
        - name: datamodificacao
          in: path
          description: Data inicial de pesquisa
          required: true
          schema:
            type: string
      responses:
        200:
          description: Conhecimento
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/manifestos'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /manifestos:
    get:
      summary: Retorna lista de objetos correspondente ao filtro
      tags:
        - mercante
      responses:
        200:
          description: Conhecimento
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/manifestos'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /itens/{conhecimento}:
    get:
      summary: Retorna objeto
      tags:
        - mercante
      parameters:
        - name: conhecimento
          in: path
          description: Numero do Conhecimento no sistema original
          required: true
          schema:
            type: string
      responses:
        200:
          description: Conhecimento
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/itens'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /item/{conhecimento}/{sequencial}:
    get:
      summary: Retorna objeto
      tags:
        - mercante
      parameters:
        - name: numero
          in: path
          description: Numero do Conhecimento no sistema original
          required: true
          schema:
            type: string
        - name: sequencial
          in: path
          description: Numero sequencial no sistema original
          required: true
          schema:
            type: string
      responses:
        200:
          description: Conhecimento
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/itens'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /itens/new/{datamodificacao}:
    get:
      summary: Retorna lista de objetos com data de modificacao maior que a data passada
      tags:
        - mercante
      parameters:
        - name: datamodificacao
          in: path
          description: Data inicial de pesquisa
          required: true
          schema:
            type: string
      responses:
        200:
          description: Conhecimento
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/itens'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /itens:
    get:
      summary: Retorna lista de objetos correspondente ao filtro
      tags:
        - mercante
      responses:
        200:
          description: Conhecimento
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/itens'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /NCMitem/{conhecimento}:
    get:
      summary: Retorna objeto
      tags:
        - mercante
      parameters:
        - name: conhecimento
          in: path
          description: Numero do Conhecimento no sistema original
          required: true
          schema:
            type: string
      responses:
        200:
          description: Conhecimento
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NCMitem'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /NCMitem/{conhecimento}/{sequencial}:
    get:
      summary: Retorna objeto
      tags:
        - mercante
      parameters:
        - name: conhecimento
          in: path
          description: Numero do Conhecimento no sistema original
          required: true
          schema:
            type: string
        - name: sequencial
          in: path
          description: Numero do sequencial no sistema original
          required: true
          schema:
            type: string
      responses:
        200:
          description: Conhecimento
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NCMitem'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /NCMitem/new/{datamodificacao}:
    get:
      summary: Retorna lista de objetos com data de modificacao maior que a data passada
      tags:
        - mercante
      parameters:
        - name: datamodificacao
          in: path
          description: Data inicial de pesquisa
          required: true
          schema:
            type: string
      responses:
        200:
          description: Conhecimento
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NCMitem'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /NCMitem:
    get:
      summary: Retorna lista de objetos correspondente ao filtro
      tags:
        - mercante
      responses:
        200:
          description: Conhecimento
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NCMitem'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /ConteinerVazio/{manifesto}:
    get:
      summary: Retorna objeto
      tags:
        - mercante
      parameters:
        - name: manifesto
          in: path
          description: Numero do Manifesto no sistema original
          required: true
          schema:
            type: string
      responses:
        200:
          description: Lista de Conteineres Vazios
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/conteineresVazios'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /ConteinerVazio/new/{datamodificacao}:
    get:
      summary: Retorna lista de objetos com data de modificacao maior que a data passada
      tags:
        - mercante
      parameters:
        - name: datamodificacao
          in: path
          description: Data inicial de pesquisa
          required: true
          schema:
            type: string
      responses:
        200:
          description: Lista de Conteineres Vazios
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/conteineresVazios'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /ConteinerVazio:
    get:
      summary: Retorna lista de objetos correspondente ao filtro
      tags:
        - mercante
      responses:
        200:
          description: Lista de Conteineres Vazios
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/conteineresVazios'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /acessoveiculo/{id}:
    get:
      summary: Retorna objeto
      tags:
        - API Recintos
      parameters:
        - name: id
          in: path
          description: Id do Evento
          required: true
          schema:
            type: string
      responses:
        200:
          description: Evento Acesso Veiculo
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AcessoVeiculo'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /acessoveiculo:
    post:
      summary: Recebe Evento acessoveiculo
      tags:
        - API Recintos
      operationId: authentication.generate_token
      requestBody:
        description: Conteúdo do Evento
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AcessoVeiculo'
      responses:
        201:
          description: Resposta em caso de sucesso
          content:
            application/json:
              schema: {}
        500:
          description: Erro
          content:
            application/json:
              schema: {}
      security:
        - jwt: ['secret']
  /pesagemveiculo/{id}:
    get:
      tags:
        - API Recintos
      parameters:
        - name: id
          in: path
          description: Id do Evento
          required: true
          schema:
            type: string
      responses:
        200:
          description: Evento Pesagem Veiculo
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PesagemVeiculo'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /pesagemveiculo:
    post:
      summary: Recebe Evento pesagemveiculo
      tags:
        - API Recintos
      operationId: authentication.generate_token
      requestBody:
        description: Conteúdo do Evento
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PesagemVeiculo'
      responses:
        201:
          description: Resposta em caso de sucesso
          content:
            application/json:
              schema: {}
        500:
          description: Erro
          content:
            application/json:
              schema: {}
      security:
        - jwt: ['secret']
  /empresa/{cnpj}:
    get:
      summary: Retorna informações cadastrais da Empresa
      tags:
        - cadastros
      parameters:
        - name: cnpj
          in: path
          description: CNPJ somente numeros - mínimo 8 digitos -> busca a matriz, ou CNPJ completo.
          required: true
          schema:
            type: string
      responses:
        200:
          description: Empresa
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Empresa'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
  /empresas_e_filiais/{cnpj}:
    get:
      summary: Retorna informações cadastrais das Empresas (CNPJ parcial 8 dígitos- lista filias se existirem)
      tags:
        - cadastros
      parameters:
        - name: cnpj
          in: path
          description: CNPJ somente numeros - mínimo de 8 digitos
          required: true
          schema:
            type: string
      responses:
        200:
          description: Empresa
          content:
            application/json:
              schema:
                type: object
                array:
                  items:
                    type: object
                    $ref: '#/components/schemas/Empresa'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
  /empresas:
    post:
      summary: Retorna lista de Empresas correspondentes ao filtro
      tags:
        - cadastros
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EmpresaFiltro'
      responses:
        200:
          description: Empresa
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  $ref: '#/components/schemas/Empresa'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
      security:
        - jwt: ['secret']
  /ncm/{codigo}:
    get:
      summary: Retorna descrição da NCM
      tags:
        - cadastros
      parameters:
        - name: codigo
          in: path
          description: Codigo no formato 9999.99.99
          required: true
          schema:
            type: string
      responses:
        200:
          description: NCM descrição
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NCM'
        400:
          description: Erro
          content: {}
        404:
          description: Não encontrado para filtro atual.
          content: {}
components:
  securitySchemes:
    jwt:
      type: http
      scheme: bearer
      bearerFormat: JWT
      x-bearerInfoFunc: authentication.decode_token
  schemas:
    AuthenticationJson:
      type: object
      properties:
        username:
          type: string
        password:
          type: string
    conhecimentos:
      type: object
      properties:
        codigoEmpresaNavegacao:
          type: string
        codigoTerminalCarregamento:
          type: string
        consignatario:
          type: string
        cubagem:
          type: string
        dataAtualizacao:
          type: string
        dataEmissao:
          type: string
        descricao:
          type: string
        embarcador:
          type: string
        horaAtualizacao:
          type: string
        indicadorShipsConvenience:
          type: string
        manifestoCE:
          type: string
        numeroCEMaster:
          type: string
        numeroCEmercante:
          type: string
        paisDestinoFinalMercante:
          type: string
        portoDestFinal:
          type: string
        portoOrigemCarga:
          type: string
        tipoBLConhecimento:
          type: string
        tipoTrafego:
          type: string
    manifestos:
      type: object
      properties:
        numero:
          type: string
    Escala:
      type: object
      properties:
        numeroDaEscala:
          type: string
        dataAtualizacao:
          type: string
        horaAtualizacao:
          type: string
        agenciaDeNavegacao:
          type: string
        portoDaEscala:
          type: string
        embarcacao:
          type: string
        numeroViagemDoArmador:
          type: string
        tipoOperacaoPrevista:
          type: string
        bandeiraDaEmbarcacao:
          type: string
        empresaDeNavegacao:
          type: string
        dataPrevistaAtracacao:
          type: string
        dataPrevistaDesatracacao:
          type: string
        dataEfetivaPrimeiraAtracacao:
          type: string
        dataEfetivaPrimeiraDesatracacao:
          type: string
    itens:
      type: object
      properties:
        numeroCEmercante:
          type: string
        numeroSequencialItemCarga:
          type: string
        codigoConteiner:
          type: string
        NCM:
          type: string
    NCMitem:
      type: object
      properties:
        numeroCEmercante:
          type: string
        numeroSequencialItemCarga:
          type: string
        identicacaoNCM:
          type: string
    conteineresVazios:
      type: object
      properties:
        manifesto:
          type: string
        idConteinerVazio:
          type: string
    AcessoVeiculo:
      type: object
      properties:
        id:
          type: number
        cnpjTransportador:
          type: string
        codRecintoDestino:
          type: integer
        contingencia:
          type: boolean
        cpfOperOcor:
          type: string
        cpfOperReg:
          type: string
        direcao:
          type: string
        dtHrAgenda:
          type: string
        dtHrOcorrencia:
          type: string
        dtHrRegistro:
          type: string
        gate:
          type: string
        idEvento:
          type: string
        listaConteineresUld:
          properties: listaConteineresUld
          type: object
          $ref: '#components/schemas/listaConteinerUld'
        login:
          type: string
        mercadoria:
          type: string
        modal:
          type: string
        motorista_cpf:
          type: string
        motorista_nome:
          type: string
        motorista_protocoloCredenciamento:
          type: string
        nmtransportador:
          type: string
        ocrPlaca:
          type: boolean
        oogDimensao:
          type: boolean
        oogPeso:
          type: boolean
        operacao:
          type: string
        placa:
          type: string
        protocoloAgenda:
          type: string
        protocoloEventoRetifCanc:
          type: string
        recinto:
          type: string
        tipoGranel:
          type: string
    ConteinerUld:
      type: object
      properties:
        id:
          type: number
        avaria:
          type: boolean
        cnpjCliente:
          type: string
        destinoCarga:
          type: string
        imoNavio:
          type: string
        nmCliente:
          type: string
        num:
          type: string
        numBooking:
          type: string
        ocrNum:
          type: boolean
        portoDescarga:
          type: string
        tipo:
          type: string
        vazio:
          type: boolean
    PesagemVeiculo:
      type: object
      properties:
        id:
          type: number
        balanca:
          type: string
        capturaAutoPeso:
          type: boolean
        contingencia:
          type: boolean
        cpfOperOcor:
          type: string
        cpfOperReg:
          type: string
        dtHrOcorrencia:
          type: string
        dtHrRegistro:
          type: string
        dutos:
          type: string
        idEvento:
          type: string
        listaSemirreboque:
          properties: listaSemirreboque
          type: object
          $ref: '#components/schemas/Semirreboque'
        numConteinerUld:
          type: string
        pesoBrutoBalanca:
          type: number
        pesoBrutoManifesto:
          type: number
        placa:
          type: string
        protocoloEventoRetifCanc:
          type: string
        recinto:
          type: string
        taraConjunto:
          type: number
        taraConteinerUld:
          type: number
        tipoConteinerUld:
          type: string
        volume:
          type: number
    Semirreboque:
      type: object
      properties:
        id:
          type: number
        placa:
          type: string
        tara:
          type: number
    OVR:
      type: object
      properties:
        id:
          type: integer
        ano:
          type: string
        cnpj_fiscalizado:
          type: string
        create_date:
          type: string
        dataentrada:
          type: string
        datahora:
          type: string
        fase:
          type: integer
        flags:
          type: array
          items:
            type: string
        historico:
          type: array
          items:
            type: object
            $ref: '#components/schemas/EventoOVR'
        last_modified:
          type: string
        numero:
          type: string
        numeroCEmercante:
          type: string
        numerodeclaracao:
          type: string
        observacoes:
          type: string
        recinto_id:
          type: integer
        responsavel_cpf:
          type: string
        setor_id:
          type: string
        tgs:
          type: array
          items:
            type: object
            $ref: '#components/schemas/TGOVR'
        tipoevento_id:
          type: integer
        tipooperacao:
          type: integer
        user_name:
          type: string
    OVRFiltro:
      type: object
      properties:
        cnpj_fiscalizado:
          type: string
        datahora:
          type: string
        fase:
          type: integer
        numero:
          type: string
        numeroCEmercante:
          type: string
        numerodeclaracao:
          type: string
        recinto_id:
          type: integer
        responsavel_cpf:
          type: string
        setor_id:
          type: string
        tipoevento_id:
          type: integer
        tipooperacao:
          type: integer
        user_name:
          type: string
    RVF:
      type: object
      properties:
        id:
          type: integer
        create_date:
          type: string
        datahora:
          type: string
        descricao:
          type: string
        numeroCEmercante:
          type: string
        numerolote:
          type: string
        ovr_id:
          type: integer
        peso:
          type: number
        user_name:
          type: string
        volume:
          type: number
        last_modified:
          type: string
        imagens:
          type: array
          items:
            type: object
            $ref: '#components/schemas/ImagemRVF'
        infracoesencontradas:
          type: array
          items:
            type: string
        lacresverificados:
          type: array
          items:
            type: string
        marcasencontradas:
          type: array
          items:
            type: string
    RVFFiltro:
      type: object
      properties:
        datahora:
          type: string
        descricao:
          type: string
        numeroCEmercante:
          type: string
        numerolote:
          type: string
        user_name:
          type: string
    ImagemRVF:
      type: object
      properties:
        id:
          type: integer
        create_date:
          type: string
        descricao:
          type: string
        imagem:
          type: string
        itemtg_id:
          type: integer
        marca:
          type: string
        ordem:
          type: integer
        rvf_id:
          type: integer
        tg_id:
          type: integer
        user_name:
          type: string
    EventoOVR:
      type: object
      properties:
        id:
          type: integer
        anexo_filename:
          type: string
        create_date:
          type: string
        fase:
          type: integer
        motivo:
          type: string
        ovr_id:
          type: integer
        tipoevento_id:
          type: integer
        user_name:
          type: string
    TGOVR:
      type: object
      properties:
        id:
          type: integer
        afrfb:
          type: string
        create_date:
          type: string
        descricao:
          type: string
        identificacao:
          type: string
        itenstg:
          type: array
          items:
            type: object
            $ref: '#components/schemas/ItemTG'
        marcas:
          type: array
          items:
            type: string
        numerolote:
          type: string
        numerotg:
          type: string
        observacoes:
          type: string
        ovr_id:
          type: integer
        qtde:
          type: number
        tipomercadoria_id:
          type: integer
        unidadedemedida:
          type: integer
        user_name:
          type: string
        valor:
          type: number
    TGFiltro:
      type: object
      properties:
        afrfb:
          type: string
        descricao:
          type: string
        identificacao:
          type: string
        numerolote:
          type: string
        numerotg:
          type: string
        observacoes:
          type: string
        tipomercadoria_id:
          type: integer
    ItemTG:
      type: object
      properties:
        id:
          type: integer
        create_date:
          type: string
        descricao:
          type: string
        marca:
          type: string
        ncm:
          type: string
        numero:
          type: integer
        qtde:
          type: number
        unidadedemedida:
          type: integer
        user_name:
          type: string
        valor:
          type: number
    Empresa:
      type: object
      properties:
        cnpj:
          type: string
        nome:
          type: string
    EmpresaFiltro:
      type: object
      properties:
        nome:
          type: string
    NCM:
      type: object
      properties:
        title:
          type: string
        contents:
          type: string
